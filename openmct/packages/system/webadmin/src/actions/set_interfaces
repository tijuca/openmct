. ../actions/functions
html
thead
if [ "$FORM_eth0addr" != "" ]; then
 vexec "ifconfig eth0 $FORM_eth0addr netmask $FORM_eth0mask"
else
 echo 'ERROR: Missing parameters!'
fi
if [ "$FORM_eth1addr" != "" ]; then
 vexec "ifconfig eth1 $FORM_eth1addr netmask $FORM_eth1mask"
fi
if [ "$FORM_gwaddr" != "" ]; then
 if [ "$FORM_gwint" == "eth1" ]; then
  vexec "route del default && route add default gw $FORM_gwaddr dev eth1"
 else
  vexec "route del default && route add default gw $FORM_gwaddr dev eth0"
 fi
fi
if [ "$FORM_persistent" == "on" ]; then
 echo -n "</pre>Making changes persistent (/etc/network/interfaces) ..."
 CFG=/etc/network/interfaces
 echo 'auto lo' > $CFG
 echo 'iface lo inet loopback' >> $CFG
 echo >> $CFG
 echo 'auto eth0' >> $CFG
 echo 'iface eth0 inet static' >> $CFG
 echo "    address $FORM_eth0addr" >> $CFG
 echo "    netmask $FORM_eth0mask" >> $CFG
 if [ "$FORM_gwaddr" != "" -a "$FORM_gwint" == "eth0" ];then
  echo "    gateway $FORM_gwaddr" >> $CFG
 fi
 if [ "$FORM_eth1addr" != "" ]; then
  echo >> $CFG
  echo 'auto eth1' >> $CFG
  echo 'iface eth1 inet static' >> $CFG
  echo "    address $FORM_eth1addr" >> $CFG
  echo "    netmask $FORM_eth1mask" >> $CFG
  if [ "$FORM_gwaddr" != "" -a "$FORM_gwint" == "eth1" ];then
   echo "    gateway $FORM_gwaddr" >> $CFG
  fi
 fi
 echo -n " done"
 echo -n "<pre>"
 vexec "cat /etc/network/interfaces"
fi
tfoot
